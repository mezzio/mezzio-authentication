<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Authentication middleware for Mezzio and PSR-7 applications"> 

    
    
    <meta name="docsearch:version" content="latest">
    <meta name="docsearch:language" content="en">
    <meta name="docsearch:component" content="mezzio-authentication">

    <link rel="canonical" href="https://docs.mezzio.dev/mezzio-authentication/v1/intro/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>Introduction - mezzio-authentication - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
    
</head>
<body id="page-top" class="mezzio" data-spy="scroll" data-target=".toc" data-offset="20">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown sub-project-selector">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a href="https://docs.mezzio.dev/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mezzio-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Mezzio</strong><br>
                                        PSR-15 Middleware in Minutes
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/components/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-components-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Components</strong><br>
                                        Components for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/mvc" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mvc-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>MVC</strong><br>
                                        MVC for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://api-tools.getlaminas.org/documentation" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-api-tools-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>API Tools</strong><br>
                                        Build RESTful APIs in Minutes
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/migration/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Migration to Laminas
                                    </div>
                                </div>
                            </a>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/tutorials/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Tutorials
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">mezzio-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item subnavigation__list-item--active">
                                <a href="./" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../auth-adapter/" class="subnavigation__link">Authentication Adapters</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../user-repository/" class="subnavigation__link">User Repository</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-8">
                <h1 class="header__title">
                    Mezzio

                    
                        <small class="header__subtitle">mezzio-authentication</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/mezzio/mezzio-authentication" class="header__link header__link--github" title="Go to repository of mezzio-authentication">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12 content" role="main">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#default-user-class" class="toc__link nav-link">Default User Class</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#usage-in-the-route" class="toc__link nav-link">Usage in the Route</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#choosing-an-authentication-adapter" class="toc__link nav-link">Choosing an Authentication Adapter</a>
                    </li>
                
            </ul>
        </div>
    

                

                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.mezzio.dev/">Mezzio</a></li>

            
                <li class="breadcrumb-item"><a href="../..">mezzio-authentication</a></li>

                

                <li class="breadcrumb-item active" aria-current="page">Introduction</li>
            
        
    </ol>
</nav>






    
    

    <h1 id="introduction">Introduction</h1>
<p>This component provides authentication abstraction using a middleware approach
for <a href="http://www.php-fig.org/psr/psr-7/">PSR-7</a> and
<a href="https://github.com/php-fig/fig-standards/tree/4b417c91b89fbedaf3283620ce432b6f51c80cc0/proposed/http-handlers">PSR-15</a>
applications.</p>
<p>Authentication is performed using the <a href="https://github.com/mezzio/mezzio-authentication/blob/master/src/AuthenticationMiddleware.php">AuthenticationMiddleware</a>
class. This middleware consumes an <a href="https://github.com/mezzio/mezzio-authentication/blob/master/src/AuthenticationInterface.php">AuthenticationInterface</a>
adapter to check if a <a href="http://www.php-fig.org/psr/psr-7/">PSR-7</a> request is
authenticated or not. If authenticated, the middleware executes the next
middleware in the application, passing a <a href="https://github.com/mezzio/mezzio-authentication/blob/master/src/UserInterface.php">UserInterface</a>
object via a request attribute. If the request is not authenticated, the
middleware returns a <code>401 Unauthorized</code> response based on the authentication
adapter provided.</p>
<p>The <code>Mezzio\Authentication\UserInterface</code> is defined as follows:</p>
<pre class="highlight"><code class="language-php">namespace Mezzio\Authentication;

interface UserInterface
{
    /**
     * Get the unique user identity (id, username, email address, etc.).
     */
    public function getIdentity() : string;

    /**
     * Get all user roles.
     *
     * @return string[]
     */
    public function getRoles() : array;

    /**
     * Get the detail named $name if present; return $default otherwise.
     */
    public function getDetail(string $name, $default = null);

    /**
     * Get all additional user details, if any.
     */
    public function getDetails() : array;
}</code></pre>
<p>The <code>UserInterface</code> attribute in the PSR-7 request can be used for checking
if a user has been authenticated or not, e.g. it can be used to verify the
authorization level of a user (for this scope, it is consumed by
<a href="https://github.com/mezzio/mezzio-authorization">mezzio-authorization</a>).</p>
<p>For example:</p>
<pre class="highlight"><code class="language-php">// Retrieve the UserInterface object from the request.
$user = $request-&gt;getAttribute(UserInterface::class);

// Retrieve the user's identity.
$user-&gt;getIdentity();

// Retrieve the user's roles (if any).
$user-&gt;getRoles();

// Retrieve the user's other details (if any).
$user-&gt;getDetails();</code></pre>
<h2 id="default-user-class">Default User Class</h2>
<p>We provide a default implementation of <code>UserInterface</code> via the class
<code>Mezzio\Authentication\DefaultUser</code>. The class is final and immutable,
in order to prevent runtime changes.</p>
<p>Repositories will fetch user information based on the identity, including any
associated roles, and optionally any additional details (full name, email,
profile information, etc.). Often, user data and the objects representing them
are unique to the application. As such, the default repository implementations
we provide allow you to inject a <em>factory</em> for producing the user. This factory
should be a PHP callable with the following signature:</p>
<pre class="highlight"><code class="language-php">function (string $identity, array $roles = [], array $details = []) : UserInterface</code></pre>
<p>In order to notify the package to use your custom factory, you will need to
create a service factory that returns it, and map it to the
<code>Mezzio\Authentication\UserInterface</code> service.</p>
<p>We provide a service factory named <code>Mezzio\Authentication\DefaultUserFactory</code>
that returns a user factory that produces a <code>DefaultUser</code> instance from the
arguments provided. This is mapped as follows in the service configuration:</p>
<pre class="highlight"><code class="language-php">use Mezzio\Authentication\DefaultUserFactory;
use Mezzio\Authentication\UserInterface;

return [
    // ...
    'dependencies' =&gt; [
        'factories' =&gt; [
            // ...
            // Change the DefaultUserFactory::class with your custom service
            // factory that produces a user factory:
            UserInterface::class =&gt; DefaultUserFactory::class
        ]
    ]
];</code></pre>
<h2 id="usage-in-the-route">Usage in the Route</h2>
<p>The <code>AuthenticationMiddleware</code> can be used to authenticate a route. You just
need to add the class name of the middleware in the pipeline of a route.
As an example:</p>
<pre class="highlight"><code class="language-php">$app-&gt;get('/admin/dashboard', [
    Mezzio\Authentication\AuthenticationMiddleware::class,
    Admin\Action\Dashboard::class
], 'admin.dashboard');</code></pre>
<p>In this example, the <code>AuthenticationMiddleware</code> is executed as first middleware
of the route <code>admin.dashboard</code>. If the user is authenticated, the application
executes the <code>Dashboard</code> action; otherwise it returns a <code>401 Unauthorized</code>
response.</p>
<h2 id="choosing-an-authentication-adapter">Choosing an Authentication Adapter</h2>
<p>You can choose an authentication adapter and a user repository through the
service container configuration.</p>
<p>You need to specify the service for authentication using the name
<code>Mezzio\Authentication\AuthenticationInterface</code> and the user registry
using the service name <code>Mezzio\Authentication\UserRepositoryInterface::class</code>.</p>
<p>For instance, using <code>laminas-servicemanager</code> you can easily configure these two
services using <code>aliases</code>. Below is an example of configuration using the <em>HTTP
Basic Access Authentication</em> adapter and the <em>htpasswd</em> file as the user
repository.</p>
<pre class="highlight"><code class="language-php">use Mezzio\Authentication\AuthenticationInterface;
use Mezzio\Authentication\Basic;
use Mezzio\Authentication\UserRepository;
use Mezzio\Authentication\UserRepositoryInterface;

return [
    // ...
    'dependencies' =&gt; [
        // ...
        'aliases' =&gt; [
            // ...
            AuthenticationInterface::class =&gt; Basic\BasicAccess::class,
            UserRepositoryInterface::class =&gt; UserRepository\Htpasswd::class
        ]
    ]
];</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../..">
                    <small class="page-nav__label">Previous</small>
                    <i class="fa fa-chevron-left"></i>
                    Home
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../auth-adapter/">
                    <small class="page-nav__label">Next</small>
                    Authentication Adapters
                    <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                <div class="donation-banner">
    <a href="https://getlaminas.org/support/">
        <h2>Donate</h2>
        <p>Support Laminas Developers Directly</p>
        <img src="https://funding.communitybridge.org/assets/cb-f-horizontal-white.svg">
    </a>
</div>

                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">mezzio-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item subnavigation__list-item--active">
                                <a href="./" class="subnavigation__link">Introduction</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Reference</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../auth-adapter/" class="subnavigation__link">Authentication Adapters</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../user-repository/" class="subnavigation__link">User Repository</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                    
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="row">

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Support</h4>
                        <ul class="support__list">
                            <li class="support__list-item">
                                <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://twitter.com/getlaminas" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/blog/rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                            </li>
                        </ul>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">License</h4>
                        <p>
                            Code licensed under <a
                                href="https://github.com/mezzio/mezzio-authentication/blob/-/LICENSE.md">BSD 3-Clause</a>.
                        </p>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Copyright</h4>
                        <p>
                            <!--Built with love by the Laminas team with the help of our
                            <a href="https://github.com/mezzio/mezzio-authentication/graphs/contributors">contributors</a>.<br>-->
                            &copy; 2023 <a href="https://getlaminas.org/">Laminas Project</a> a Series of LF Projects, LLC.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '../..',
            project  = "mezzio",
            siteName = 'mezzio-authentication';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
    
        <script src="../../search/main.js"></script>
    

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in mezzio-authentication" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
